{
  "hash": "08eefda068f367642811a2156c5515b3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"equations\"\nauthor: Brian M. Schilder\ndate: \"2024-07-22\"\nformat:\n  pdf:\n    header-includes:\n      - \\usepackage{annotate-equations}\neditor: visual  \n---\n\n\n# Tutorials\n\n-   <https://lpembleton.rbind.io/posts/annotate-equations/>\n-   <https://github.com/st--/annotate-equations/blob/main/annotate-equations.pdf>\n\n# Install latex\n\nOnly need to do this once. Instructions [using `homebrew`](https://formulae.brew.sh/formula/texlive):\n\n``` bash\nbrew install texlive\n```\n\nor [using quarto](https://quarto.org/docs/get-started/authoring/rstudio.html#format-options):\n\n``` bash\nquarto install tinytex\n```\n\n# Methods\n\n### Human Phenotype Ontology\n\nLet us denote:\n\n-   $D$ as the set of $d$ diseases.\n\n-   $p$ as a phenotype.\n\n-   $g$ as a gene.\n\nThe final evidence-weighted gene x phenotype matrix $M_g,p$ can be expressed as:\n\n$$\nM _{g,p} = \\frac{\\sum_{d \\in D} \\text{R}(g,p,d) \\times \\text{E}(g,d)}{\\sum_{d \\in D} \\text{R}(g,p,d)} \n$$\n\n\\\n\n\n```{=tex #eq-evidence-scores}\n\\begin{equation*}\n  \\eqnmarkbox[NavyBlue]{n1}{M_{g,p}}\n  =\n  \\frac{\n    \\eqnmarkbox[Cerulean]{n3a}{\\sum_{d \\in D}}\n    \\eqnmarkbox[blue]{n4a}{R(g,p,d)} \n    \\times \n    \\eqnmarkbox[BlueViolet]{n5}{E(g,d)}  \n  }{\n    \\eqnmarkbox[Cerulean]{n3b}{\\sum_{d \\in D}}\n    \\eqnmarkbox[blue]{n4b}{R(g,p,d)}\n  }\n\\end{equation*}\n\\annotate[yshift=1em]{left}{n1}{Weighted gene-by-phenotype \\\\evidence score matrix} \n\\annotate[yshift=-2em]{below,left}{n3a,n3b}{Iterate over all diseases}\n\\annotate[yshift=-2.5em,xshift=2.5em]{below,right}{n4a,n4b}{Binary gene-by-phenotype \\\\relationship matrix,\\\\ (1=relationship, 0=no relationship)}\n\\annotate[yshift=2em]{left}{n5}{Weighted gene-by-disease \\\\evidence score matrix}\n```\n\n\\\n\n## Single-cell transcriptomic atlases\n\nLet us denote:\\\n- $g$ as a gene.\\\n- $c$ as a cell type.\\\n- $i$ as a single cell.\n\nGenes with very no expression across any cell types were considered to be uninformative and were therefore removed before computing the specificity matrix.\n\n$$\nF(g,i,c) = \\begin{cases}r_{g,i},\\text{ }l_i = c\\\\0,\\text{ }l_i \\neq c \\end{cases}\n$$\n\n\\\n\n\n```{=tex #eq-ctd-filter}\n\\begin{equation*}\n  \\eqnmarkbox[purple]{f1}{F(g,i,c)}\n  =\n  \\begin{cases}\n  \\eqnmarkbox[WildStrawberry]{f2}{r_{g,i}},\n  \\text{ }l_i = c\\\\0,\n  \\text{ }l_i \\neq c \n  \\end{cases}\n\\end{equation*}\n\\annotate[yshift=1em]{left}{f1}{Filtered gene-by-cell expression matrix} \n\\annotate[yshift=2em]{left}{f2}{Expression of gene $g$ in cell $i$} \n```\n\n\n\\\n\nThe gene expression specificity matrix construction can be defined as the following:\n\n$$\nS_{g,c} = \\frac{\n\\frac{\\sum_{i=1}^{|L|}F(g,i,c)}{N_c}\n}{\\sum_{r=1}^{k}(\\frac{\\sum_{i=1}^{|L|}F(g,i,c)}{N_c})}\n$$\n\n\\\n\n\n```{=tex #eq-ctd-specificity}\n\\begin{equation*}\n  \\eqnmarkbox[orange]{s1}{S_{g,c}}\n  =\n  \\frac{\n    \\eqnmarkbox[purple]{s3a}{\n      \\frac{\n        \\sum_{i=1}^{|L|} F(g,i,c)\n      }{\n        N_c  \n      }\n    } \n  }{\n   \\eqnmarkbox[OrangeRed]{s6}{\\sum_{r=1}^{k}}(\n     \\eqnmarkbox[purple]{s3b}{\n      \\frac{\n        \\sum_{i=1}^{|L|} F(g,i,c)\n      }{\n        N_c  \n      }\n    } \n   ) \n  }\n\\end{equation*}\n\\annotate[yshift=1em]{left}{s1}{Gene-by-cell type specificity matrix} \n\\annotate[yshift=2em]{left}{s3a,s3b}{Compute mean expression of each gene per cell type} \n\\annotate{below,left}{s6}{Compute row sums of \\\\mean gene-by-cell type matrix}\n```\n\n\\\n\n## Symptom-cell type associations\n\n$$\n\\frac{|G_{d \\cap p \\cap c} |}{|G_{d,p} |}\\geq0.25\n$$\n\n\\\n\n\n```{=tex #eq-symptoms}\n\\begin{equation*}\n  \\frac{\n     \\eqnmarkbox[Chartreuse3]{g1}{|G_{d \\cap p \\cap c} |}\n    }{\n       \\eqnmarkbox[Emerald]{g2}{|G_{d,p}|}} \n  \\geq \\eqnmarkbox[SeaGreen]{g3}{.25} \n\\end{equation*}\n\\annotate[yshift=1em]{left}{g1}{Intersect between \\\\symptom genes ($G_{d,p}$) and driver genes ($G_{p,c}$)} \n\\annotate[yshift=-1em]{below,left}{g2}{Symptom genes \\\\(i.e. genes annotated to a phenotype\\\\ via a specific disease)} \n\\annotate[yshift=-1em]{below,right}{g3}{Minimum proportion of overlap \\\\between $G_{d,p,c}$ and $G_{d,p}$}\n```\n\n\\\n\n## Annotation of phenotypes using generative large language models\n\n\\\n\n$$ \nNSS_p = \n\\frac{\\\n\\sum_{j=1}^{m} (F_{pj} \\times W_j)}{ \n\\sum_{j=1}^{m}(\\max\\{F_j\\} \\times W_j)\n} \\times 100 \n$$\n\n\\\n\n\\\n\n\n```{=tex #eq-gpt}\n\\begin{equation*}\n  \\eqnmarkbox[Brown4]{nss}{NSS_p}\n  =\n  \\frac{ \n    \\eqnmarkbox[Goldenrod]{nss2}{\\sum_{j=1}^{m}} \n    (\n      \\eqnmarkbox[Goldenrod4]{nss3}{F_{pj}}\n      \\times \n      \\eqnmarkbox[IndianRed4]{nss4}{W_j}\n    )\n    }{\n    \\eqnmarkbox[Tan]{nss5}{\\sum_{j=1}^{m}(\\max\\{F_j\\} \\times W_j)} \n  } \\times 100\n\\end{equation*}\n\\annotate[yshift=1em]{left}{nss}{Normalised Severity Score \\\\for each phenotype}\n\\annotate[yshift=3em]{left}{nss2}{Sum of weighted annotation values \\\\across all metrics}\n\\annotate[yshift=3em]{right}{nss3}{Numerically encoded annotation value \\\\of metric $j$ for phenotype $p$}\n\\annotate[yshift=1em]{right}{nss4}{Weight for metric $j$} \n\\annotate[yshift=-1em]{below,right}{nss5}{Theoretical maximum severity score}\n```\n\n\n\\\n\n# Session Info\n\n<details>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nutils::sessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.5\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n [1] compiler_4.3.1    fastmap_1.1.1     cli_3.6.2         tools_4.3.1      \n [5] htmltools_0.5.8.1 rstudioapi_0.16.0 yaml_2.3.8        rmarkdown_2.26   \n [9] knitr_1.45        jsonlite_1.8.8    xfun_0.43         digest_0.6.35    \n[13] rlang_1.1.3       evaluate_0.23    \n```\n\n\n:::\n:::\n\n\n</details>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}