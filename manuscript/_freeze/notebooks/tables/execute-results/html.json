{
  "hash": "1a1f76ad14f9d647d29d52cb9392cd65",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tables\"\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(data.table)\nhpo <- HPOExplorer::get_hpo()\n```\n:::\n\n::: {#tbl-summary .cell tbl-cap='Summary statistics of enrichment results stratified by single-cell atlas. Summary statistics at multiple levels (tests, cell types, phenotypes, diseases, cell types per phenotype, phenotypes per cell type) stratified by the single-cell atlas that was used as a cell type signature reference (Descartes Human or Human Cell Atlas).'}\n\n```{.r .cell-code .hidden}\n#| label: tbl-summary\n#| tbl-cap: Summary statistics of enrichment results stratified by single-cell atlas. Summary statistics at multiple levels (tests, cell types, phenotypes, diseases, cell types per phenotype, phenotypes per cell type) stratified by the single-cell atlas that was used as a cell type signature reference (Descartes Human or Human Cell Atlas).\n\ndata.frame(res_summ$tmerged[,-c(\"ctd\")], \n             row.names = res_summ$tmerged$ctd,\n             check.names = FALSE) |>\n  t()|>\n  knitr::kable()\n```\n:::\n\n::: {#tbl-gencc .cell tbl-cap='Encodings for GenCC evidence scores. Assigned numeric values for the GenCC evidence levels.'}\n\n```{.r .cell-code .hidden}\n#| label: tbl-gencc\n#| tbl-cap: Encodings for GenCC evidence scores. Assigned numeric values for the GenCC evidence levels.\n\ngencc <- KGExplorer::get_gencc(agg_by=NULL)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nGathering data from GenCC.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nImporting cached file.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nEvidence scores for: \n - 10390 diseases \n - 5142 genes\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n+ Version: 2024-04-13\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: tbl-gencc\n#| tbl-cap: Encodings for GenCC evidence scores. Assigned numeric values for the GenCC evidence levels.\n\ndict <- eval(formals(KGExplorer::get_gencc)$dict)\ngencc_tbl <- gencc[,list(classification_title=unique(classification_title)),\n                   by=\"classification_curie\"][,encoding:=dict[classification_title]]|>\n  data.table::setorderv(\"encoding\",-1)\nknitr::kable(gencc_tbl)\n```\n\n::: {.cell-output-display}\n\n\n|classification_curie |classification_title          | encoding|\n|:--------------------|:-----------------------------|--------:|\n|GENCC:100001         |Definitive                    |        6|\n|GENCC:100002         |Strong                        |        5|\n|GENCC:100003         |Moderate                      |        4|\n|GENCC:100009         |Supportive                    |        3|\n|GENCC:100004         |Limited                       |        2|\n|GENCC:100005         |Disputed Evidence             |        1|\n|GENCC:100008         |No Known Disease Relationship |        0|\n|GENCC:100006         |Refuted Evidence              |        0|\n\n\n:::\n:::\n\n::: {#tbl-celltypes .cell tbl-cap='On-target cell types for each HPO ancestral branch.'}\n\n```{.r .cell-code .hidden}\n#| label: tbl-celltypes\n#| tbl-cap: On-target cell types for each HPO ancestral branch.\n\ntarget_branches <- MSTExplorer:::get_target_branches()\ntarget_celltypes <- MSTExplorer:::get_target_celltypes(target_branches=target_branches)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\ncardiocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading cached ontology: /Users/bms20/Library/Caches/org.R-project.R/R/KGExplorer/cl.rds\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nendocrine cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nphotoreceptor cellretinal cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nleukocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\ncell of skeletal musclechondrocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nneural cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nrespiratory epithelial cellepithelial cell of lung\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: tbl-celltypes\n#| tbl-cap: On-target cell types for each HPO ancestral branch.\n\nhpo <- HPOExplorer::get_hpo()\ncelltype_maps <- MSTExplorer::celltype_maps|> data.table::setkeyv(\"cl_id\")\n\nct_dt <- lapply(names(target_celltypes), function(b){\n  cl_ids <- intersect(target_celltypes[[b]],\n                      celltype_maps$cl_id) \n  data.table::data.table(hpo_branch=b, \n                         hpo_branch_id=HPOExplorer::map_phenotypes(b,\n                                                                   hpo = hpo,\n                                                                   to=\"id\"),\n                         cl_branch=paste0(target_branches[[b]],collapse=\" / \"),\n                         celltype_maps[cl_ids,c(\"cl_name\",\"cl_id\")])\n}) |> data.table::rbindlist(fill=TRUE) |> unique()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: tbl-celltypes\n#| tbl-cap: On-target cell types for each HPO ancestral branch.\n\nknitr::kable(ct_dt)\n```\n\n::: {.cell-output-display}\n\n\n|hpo_branch                                |hpo_branch_id |cl_branch                                             |cl_name                                    |cl_id      |\n|:-----------------------------------------|:-------------|:-----------------------------------------------------|:------------------------------------------|:----------|\n|Abnormality of the cardiovascular system  |HP:0001626    |cardiocyte                                            |cardiac muscle cell                        |CL:0000746 |\n|Abnormality of the cardiovascular system  |HP:0001626    |cardiocyte                                            |regular atrial cardiac myocyte             |CL:0002129 |\n|Abnormality of the cardiovascular system  |HP:0001626    |cardiocyte                                            |endocardial cell                           |CL:0002350 |\n|Abnormality of the cardiovascular system  |HP:0001626    |cardiocyte                                            |epicardial adipocyte                       |CL:1000309 |\n|Abnormality of the cardiovascular system  |HP:0001626    |cardiocyte                                            |ventricular cardiac muscle cell            |CL:2000046 |\n|Abnormality of the endocrine system       |HP:0000818    |endocrine cell                                        |endocrine cell                             |CL:0000163 |\n|Abnormality of the endocrine system       |HP:0000818    |endocrine cell                                        |neuroendocrine cell                        |CL:0000165 |\n|Abnormality of the endocrine system       |HP:0000818    |endocrine cell                                        |chromaffin cell                            |CL:0000166 |\n|Abnormality of the eye                    |HP:0000478    |photoreceptor cell / retinal cell                     |photoreceptor cell                         |CL:0000210 |\n|Abnormality of the eye                    |HP:0000478    |photoreceptor cell / retinal cell                     |amacrine cell                              |CL:0000561 |\n|Abnormality of the eye                    |HP:0000478    |photoreceptor cell / retinal cell                     |Mueller cell                               |CL:0000636 |\n|Abnormality of the eye                    |HP:0000478    |photoreceptor cell / retinal cell                     |retinal pigment epithelial cell            |CL:0002586 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |T cell                                     |CL:0000084 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |mature neutrophil                          |CL:0000096 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |mast cell                                  |CL:0000097 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |microglial cell                            |CL:0000129 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |professional antigen presenting cell       |CL:0000145 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |macrophage                                 |CL:0000235 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |B cell                                     |CL:0000236 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |dendritic cell                             |CL:0000451 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |monocyte                                   |CL:0000576 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |plasma cell                                |CL:0000786 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |alternatively activated macrophage         |CL:0000890 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |thymocyte                                  |CL:0000893 |\n|Abnormality of the immune system          |HP:0002715    |leukocyte                                             |innate lymphoid cell                       |CL:0001065 |\n|Abnormality of the musculoskeletal system |HP:0033127    |cell of skeletal muscle / chondrocyte                 |chondrocyte                                |CL:0000138 |\n|Abnormality of the musculoskeletal system |HP:0033127    |cell of skeletal muscle / chondrocyte                 |cell of skeletal muscle                    |CL:0000188 |\n|Abnormality of the musculoskeletal system |HP:0033127    |cell of skeletal muscle / chondrocyte                 |skeletal muscle satellite cell             |CL:0000594 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |bipolar neuron                             |CL:0000103 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |granule cell                               |CL:0000120 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |Purkinje cell                              |CL:0000121 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |glial cell                                 |CL:0000125 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |astrocyte                                  |CL:0000127 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |oligodendrocyte                            |CL:0000128 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |microglial cell                            |CL:0000129 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |neuroendocrine cell                        |CL:0000165 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |chromaffin cell                            |CL:0000166 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |photoreceptor cell                         |CL:0000210 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |inhibitory interneuron                     |CL:0000498 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |neuron                                     |CL:0000540 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |neuronal brush cell                        |CL:0000555 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |amacrine cell                              |CL:0000561 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |GABAergic neuron                           |CL:0000617 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |Mueller cell                               |CL:0000636 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |glutamatergic neuron                       |CL:0000679 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |retinal ganglion cell                      |CL:0000740 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |retina horizontal cell                     |CL:0000745 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |Schwann cell                               |CL:0002573 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |retinal pigment epithelial cell            |CL:0002586 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |visceromotor neuron                        |CL:0005025 |\n|Abnormality of the nervous system         |HP:0000707    |neural cell                                           |sympathetic neuron                         |CL:0011103 |\n|Abnormality of the respiratory system     |HP:0002086    |respiratory epithelial cell / epithelial cell of lung |type II pneumocyte                         |CL:0002063 |\n|Abnormality of the respiratory system     |HP:0002086    |respiratory epithelial cell / epithelial cell of lung |epithelial cell of lower respiratory tract |CL:0002632 |\n\n\n:::\n:::\n\n::: {#tbl-death .cell tbl-cap='Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.'}\n\n```{.r .cell-code .hidden}\n#| label: tbl-death\n#| tbl-cap: Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.\nhpo_deaths <- KGExplorer::get_ontology_descendants(ont = hpo,\n                                                   include_self = FALSE,\n                                                   terms = \"Age of death\")[[1]]\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAge of death\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: tbl-death\n#| tbl-cap: Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.\ndeaths_dt <- data.table::data.table(hpo_id=hpo_deaths)\ndeaths_dt <- HPOExplorer::add_hpo_name(deaths_dt)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAdding HPO names.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nTranslating ontology terms to names.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: tbl-death\n#| tbl-cap: Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.\ndict <- HPOExplorer:::hpo_dict(type=\"AgeOfDeath\")\ndeaths_dt[,encoding:=dict[hpo_name]] |>\n  data.table::setorderv(\"encoding\")\nknitr::kable(deaths_dt)\n```\n\n::: {.cell-output-display}\n\n\n|hpo_id     |hpo_name                 | encoding|\n|:----------|:------------------------|--------:|\n|HP:0003826 |Stillbirth               |        1|\n|HP:0005268 |Miscarriage              |        1|\n|HP:0034241 |Prenatal death           |        1|\n|HP:0003811 |Neonatal death           |        2|\n|HP:0001522 |Death in infancy         |        3|\n|HP:0003819 |Death in childhood       |        4|\n|HP:0011421 |Death in adolescence     |        5|\n|HP:0100613 |Death in early adulthood |        6|\n|HP:0033763 |Death in adulthood       |        7|\n|HP:0033764 |Death in middle age      |        7|\n|HP:0033765 |Death in late adulthood  |        8|\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}