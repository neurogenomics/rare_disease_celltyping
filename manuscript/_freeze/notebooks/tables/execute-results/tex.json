{
  "hash": "5c9b22aef9775885fbbebb7f9922b874",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tables\"\nformat:\n  nature-pdf:\n    journal: \"sn-nature\"\n    keep-tex: true\n    execute:\n      cache: true\n      echo: false\n  pdf: default\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nhpo <- HPOExplorer::get_hpo()\n```\n:::\n\n::: {#tbl-summary .cell tbl-cap='Summary statistics of enrichment results stratified by single-cell atlas. Summary statistics at multiple levels (tests, cell types, phenotypes, diseases, cell types per phenotype, phenotypes per cell type) stratified by the single-cell atlas that was used as a cell type signature reference (Descartes Human or Human Cell Atlas).'}\n\n```{.r .cell-code}\ndata.frame(res_summ$tmerged[,-c(\"ctd\")], \n             row.names = res_summ$tmerged$ctd,\n             check.names = FALSE) |>\n  t()\n```\n:::\n\n::: {#tbl-gencc .cell tbl-cap='Encodings for GenCC evidence scores. Assigned numeric values for the GenCC evidence levels.'}\n\n```{.r .cell-code}\ngencc <- KGExplorer::get_gencc(agg_by=NULL)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGathering data from GenCC.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nImporting cached file.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nEvidence scores for: \n - 10390 diseases \n - 5142 genes\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n+ Version: 2024-04-13\n```\n\n\n:::\n\n```{.r .cell-code}\ndict <- eval(formals(KGExplorer::get_gencc)$dict)\ngencc_tbl <- gencc[,list(classification_title=unique(classification_title)),\n                   by=\"classification_curie\"][,encoding:=dict[classification_title]]|>\n  data.table::setorderv(\"encoding\",-1)\ngencc_tbl\n```\n:::\n\n::: {#tbl-celltypes .cell tbl-cap='On-target cell types for each HPO ancestral branch.'}\n\n```{.r .cell-code}\ntarget_branches <- MSTExplorer:::get_target_branches()\ntarget_celltypes <- MSTExplorer:::get_target_celltypes(target_branches=target_branches)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncardiocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading cached ontology: /Users/bms20/Library/Caches/org.R-project.R/R/KGExplorer/cl.rds\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nendocrine cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nphotoreceptor cellretinal cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nleukocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncell of skeletal musclechondrocyte\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nneural cell\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nrespiratory epithelial cellepithelial cell of lung\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code}\nhpo <- HPOExplorer::get_hpo()\ncelltype_maps <- MSTExplorer::celltype_maps|> data.table::setkeyv(\"cl_id\")\n\nct_dt <- lapply(names(target_celltypes), function(b){\n  cl_ids <- intersect(target_celltypes[[b]],\n                      celltype_maps$cl_id) \n  data.table::data.table(hpo_branch=b, \n                         hpo_branch_id=HPOExplorer::map_phenotypes(b,\n                                                                   hpo = hpo,\n                                                                   to=\"id\"),\n                         cl_branch=paste0(target_branches[[b]],collapse=\" / \"),\n                         celltype_maps[cl_ids,c(\"cl_name\",\"cl_id\")])\n}) |> data.table::rbindlist(fill=TRUE) |> unique()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code}\nct_dt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                   hpo_branch hpo_branch_id\n                                       <char>        <char>\n 1:  Abnormality of the cardiovascular system    HP:0001626\n 2:  Abnormality of the cardiovascular system    HP:0001626\n 3:  Abnormality of the cardiovascular system    HP:0001626\n 4:  Abnormality of the cardiovascular system    HP:0001626\n 5:  Abnormality of the cardiovascular system    HP:0001626\n 6:       Abnormality of the endocrine system    HP:0000818\n 7:       Abnormality of the endocrine system    HP:0000818\n 8:       Abnormality of the endocrine system    HP:0000818\n 9:                    Abnormality of the eye    HP:0000478\n10:                    Abnormality of the eye    HP:0000478\n11:                    Abnormality of the eye    HP:0000478\n12:                    Abnormality of the eye    HP:0000478\n13:          Abnormality of the immune system    HP:0002715\n14:          Abnormality of the immune system    HP:0002715\n15:          Abnormality of the immune system    HP:0002715\n16:          Abnormality of the immune system    HP:0002715\n17:          Abnormality of the immune system    HP:0002715\n18:          Abnormality of the immune system    HP:0002715\n19:          Abnormality of the immune system    HP:0002715\n20:          Abnormality of the immune system    HP:0002715\n21:          Abnormality of the immune system    HP:0002715\n22:          Abnormality of the immune system    HP:0002715\n23:          Abnormality of the immune system    HP:0002715\n24:          Abnormality of the immune system    HP:0002715\n25:          Abnormality of the immune system    HP:0002715\n26: Abnormality of the musculoskeletal system    HP:0033127\n27: Abnormality of the musculoskeletal system    HP:0033127\n28: Abnormality of the musculoskeletal system    HP:0033127\n29:         Abnormality of the nervous system    HP:0000707\n30:         Abnormality of the nervous system    HP:0000707\n31:         Abnormality of the nervous system    HP:0000707\n32:         Abnormality of the nervous system    HP:0000707\n33:         Abnormality of the nervous system    HP:0000707\n34:         Abnormality of the nervous system    HP:0000707\n35:         Abnormality of the nervous system    HP:0000707\n36:         Abnormality of the nervous system    HP:0000707\n37:         Abnormality of the nervous system    HP:0000707\n38:         Abnormality of the nervous system    HP:0000707\n39:         Abnormality of the nervous system    HP:0000707\n40:         Abnormality of the nervous system    HP:0000707\n41:         Abnormality of the nervous system    HP:0000707\n42:         Abnormality of the nervous system    HP:0000707\n43:         Abnormality of the nervous system    HP:0000707\n44:         Abnormality of the nervous system    HP:0000707\n45:         Abnormality of the nervous system    HP:0000707\n46:         Abnormality of the nervous system    HP:0000707\n47:         Abnormality of the nervous system    HP:0000707\n48:         Abnormality of the nervous system    HP:0000707\n49:         Abnormality of the nervous system    HP:0000707\n50:         Abnormality of the nervous system    HP:0000707\n51:         Abnormality of the nervous system    HP:0000707\n52:     Abnormality of the respiratory system    HP:0002086\n53:     Abnormality of the respiratory system    HP:0002086\n                                   hpo_branch hpo_branch_id\n                                                cl_branch\n                                                   <char>\n 1:                                            cardiocyte\n 2:                                            cardiocyte\n 3:                                            cardiocyte\n 4:                                            cardiocyte\n 5:                                            cardiocyte\n 6:                                        endocrine cell\n 7:                                        endocrine cell\n 8:                                        endocrine cell\n 9:                     photoreceptor cell / retinal cell\n10:                     photoreceptor cell / retinal cell\n11:                     photoreceptor cell / retinal cell\n12:                     photoreceptor cell / retinal cell\n13:                                             leukocyte\n14:                                             leukocyte\n15:                                             leukocyte\n16:                                             leukocyte\n17:                                             leukocyte\n18:                                             leukocyte\n19:                                             leukocyte\n20:                                             leukocyte\n21:                                             leukocyte\n22:                                             leukocyte\n23:                                             leukocyte\n24:                                             leukocyte\n25:                                             leukocyte\n26:                 cell of skeletal muscle / chondrocyte\n27:                 cell of skeletal muscle / chondrocyte\n28:                 cell of skeletal muscle / chondrocyte\n29:                                           neural cell\n30:                                           neural cell\n31:                                           neural cell\n32:                                           neural cell\n33:                                           neural cell\n34:                                           neural cell\n35:                                           neural cell\n36:                                           neural cell\n37:                                           neural cell\n38:                                           neural cell\n39:                                           neural cell\n40:                                           neural cell\n41:                                           neural cell\n42:                                           neural cell\n43:                                           neural cell\n44:                                           neural cell\n45:                                           neural cell\n46:                                           neural cell\n47:                                           neural cell\n48:                                           neural cell\n49:                                           neural cell\n50:                                           neural cell\n51:                                           neural cell\n52: respiratory epithelial cell / epithelial cell of lung\n53: respiratory epithelial cell / epithelial cell of lung\n                                                cl_branch\n                                       cl_name      cl_id\n                                        <char>     <char>\n 1:                        cardiac muscle cell CL:0000746\n 2:             regular atrial cardiac myocyte CL:0002129\n 3:                           endocardial cell CL:0002350\n 4:                       epicardial adipocyte CL:1000309\n 5:            ventricular cardiac muscle cell CL:2000046\n 6:                             endocrine cell CL:0000163\n 7:                        neuroendocrine cell CL:0000165\n 8:                            chromaffin cell CL:0000166\n 9:                         photoreceptor cell CL:0000210\n10:                              amacrine cell CL:0000561\n11:                               Mueller cell CL:0000636\n12:            retinal pigment epithelial cell CL:0002586\n13:                                     T cell CL:0000084\n14:                          mature neutrophil CL:0000096\n15:                                  mast cell CL:0000097\n16:                            microglial cell CL:0000129\n17:       professional antigen presenting cell CL:0000145\n18:                                 macrophage CL:0000235\n19:                                     B cell CL:0000236\n20:                             dendritic cell CL:0000451\n21:                                   monocyte CL:0000576\n22:                                plasma cell CL:0000786\n23:         alternatively activated macrophage CL:0000890\n24:                                  thymocyte CL:0000893\n25:                       innate lymphoid cell CL:0001065\n26:                                chondrocyte CL:0000138\n27:                    cell of skeletal muscle CL:0000188\n28:             skeletal muscle satellite cell CL:0000594\n29:                             bipolar neuron CL:0000103\n30:                               granule cell CL:0000120\n31:                              Purkinje cell CL:0000121\n32:                                 glial cell CL:0000125\n33:                                  astrocyte CL:0000127\n34:                            oligodendrocyte CL:0000128\n35:                            microglial cell CL:0000129\n36:                        neuroendocrine cell CL:0000165\n37:                            chromaffin cell CL:0000166\n38:                         photoreceptor cell CL:0000210\n39:                     inhibitory interneuron CL:0000498\n40:                                     neuron CL:0000540\n41:                        neuronal brush cell CL:0000555\n42:                              amacrine cell CL:0000561\n43:                           GABAergic neuron CL:0000617\n44:                               Mueller cell CL:0000636\n45:                       glutamatergic neuron CL:0000679\n46:                      retinal ganglion cell CL:0000740\n47:                     retina horizontal cell CL:0000745\n48:                               Schwann cell CL:0002573\n49:            retinal pigment epithelial cell CL:0002586\n50:                        visceromotor neuron CL:0005025\n51:                         sympathetic neuron CL:0011103\n52:                         type II pneumocyte CL:0002063\n53: epithelial cell of lower respiratory tract CL:0002632\n                                       cl_name      cl_id\n```\n\n\n:::\n:::\n\n::: {#tbl-death .cell tbl-cap='Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.'}\n\n```{.r .cell-code}\nhpo_deaths <- KGExplorer::get_ontology_descendants(ont = hpo,\n                                                   include_self = FALSE,\n                                                   terms = \"Age of death\")[[1]]\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nAge of death\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to ids.\n```\n\n\n:::\n\n```{.r .cell-code}\ndeaths_dt <- data.table::data.table(hpo_id=hpo_deaths)\ndeaths_dt <- HPOExplorer::add_hpo_name(deaths_dt)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nAdding HPO names.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTranslating ontology terms to names.\n```\n\n\n:::\n\n```{.r .cell-code}\ndict <- HPOExplorer:::hpo_dict(type=\"AgeOfDeath\")\ndeaths_dt[,encoding:=dict[hpo_name]] |>\n  data.table::setorderv(\"encoding\")\ndeaths_dt\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}