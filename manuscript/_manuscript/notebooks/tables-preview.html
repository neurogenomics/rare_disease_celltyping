<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.551">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Tables</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Tables</h6>

            <a href="../notebooks/tables.qmd" class="btn btn-primary quarto-download-embed" download="tables.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Tables</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

     <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>hpo <span class="ot">&lt;-</span> HPOExplorer<span class="sc">::</span><span class="fu">get_hpo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="tbl-summary" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Summary statistics of enrichment results stratified by single-cell atlas. Summary statistics at multiple levels (tests, cell types, phenotypes, diseases, cell types per phenotype, phenotypes per cell type) stratified by the single-cell atlas that was used as a cell type signature reference (Descartes Human or Human Cell Atlas).
</figcaption>
<div aria-describedby="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code anchored" id="tbl-summary"><pre class="sourceCode r cell code-with-copy"><code class="sourceCode r"><span id="tbl-summary-1"><a href="#tbl-summary-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-summary-2"><a href="#tbl-summary-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(res_summ<span class="sc">$</span>tmerged[,<span class="sc">-</span><span class="fu">c</span>(<span class="st">"ctd"</span>)], </span>
<span id="tbl-summary-3"><a href="#tbl-summary-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">row.names =</span> res_summ<span class="sc">$</span>tmerged<span class="sc">$</span>ctd,</span>
<span id="tbl-summary-4"><a href="#tbl-summary-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">check.names =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="tbl-summary-5"><a href="#tbl-summary-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()<span class="sc">|&gt;</span></span>
<span id="tbl-summary-6"><a href="#tbl-summary-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>gencc <span class="ot">&lt;-</span> KGExplorer<span class="sc">::</span><span class="fu">get_gencc</span>(<span class="at">agg_by=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Gathering data from GenCC.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Importing cached file.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evidence scores for: 
 - 10390 diseases 
 - 5142 genes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>+ Version: 2024-04-13</code></pre>
</div>

<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dict <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">formals</span>(KGExplorer<span class="sc">::</span>get_gencc)<span class="sc">$</span>dict)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>gencc_tbl <span class="ot">&lt;-</span> gencc[,<span class="fu">list</span>(<span class="at">classification_title=</span><span class="fu">unique</span>(classification_title)),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                   by<span class="ot">=</span><span class="st">"classification_curie"</span>][,encoding<span class="sc">:</span><span class="er">=</span>dict[classification_title]]<span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setorderv</span>(<span class="st">"encoding"</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(gencc_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-gencc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gencc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Encodings for GenCC evidence scores. Assigned numeric values for the GenCC evidence levels.
</figcaption>
<div aria-describedby="tbl-gencc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">classification_curie</th>
<th style="text-align: left;">classification_title</th>
<th style="text-align: right;">encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GENCC:100001</td>
<td style="text-align: left;">Definitive</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENCC:100002</td>
<td style="text-align: left;">Strong</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENCC:100003</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENCC:100009</td>
<td style="text-align: left;">Supportive</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENCC:100004</td>
<td style="text-align: left;">Limited</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENCC:100005</td>
<td style="text-align: left;">Disputed Evidence</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENCC:100008</td>
<td style="text-align: left;">No Known Disease Relationship</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENCC:100006</td>
<td style="text-align: left;">Refuted Evidence</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>target_branches <span class="ot">&lt;-</span> MSTExplorer<span class="sc">:::</span><span class="fu">get_target_branches</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>target_celltypes <span class="ot">&lt;-</span> MSTExplorer<span class="sc">:::</span><span class="fu">get_target_celltypes</span>(<span class="at">target_branches=</span>target_branches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>cardiocyte</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading cached ontology: /Users/bms20/Library/Caches/org.R-project.R/R/KGExplorer/cl.rds</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>endocrine cell</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>photoreceptor cellretinal cell</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>leukocyte</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>cell of skeletal musclechondrocyte</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>neural cell</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>respiratory epithelial cellepithelial cell of lung</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hpo <span class="ot">&lt;-</span> HPOExplorer<span class="sc">::</span><span class="fu">get_hpo</span>()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>celltype_maps <span class="ot">&lt;-</span> MSTExplorer<span class="sc">::</span>celltype_maps<span class="sc">|&gt;</span> data.table<span class="sc">::</span><span class="fu">setkeyv</span>(<span class="st">"cl_id"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ct_dt <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(target_celltypes), <span class="cf">function</span>(b){</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  cl_ids <span class="ot">&lt;-</span> <span class="fu">intersect</span>(target_celltypes[[b]],</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                      celltype_maps<span class="sc">$</span>cl_id) </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">hpo_branch=</span>b, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">hpo_branch_id=</span>HPOExplorer<span class="sc">::</span><span class="fu">map_phenotypes</span>(b,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">hpo =</span> hpo,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">to=</span><span class="st">"id"</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cl_branch=</span><span class="fu">paste0</span>(target_branches[[b]],<span class="at">collapse=</span><span class="st">" / "</span>),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                         celltype_maps[cl_ids,<span class="fu">c</span>(<span class="st">"cl_name"</span>,<span class="st">"cl_id"</span>)])</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> data.table<span class="sc">::</span><span class="fu">rbindlist</span>(<span class="at">fill=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.
Translating ontology terms to ids.
Translating ontology terms to ids.
Translating ontology terms to ids.
Translating ontology terms to ids.
Translating ontology terms to ids.
Translating ontology terms to ids.</code></pre>
</div>

<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ct_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-celltypes" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-celltypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
On-target cell types for each HPO ancestral branch.
</figcaption>
<div aria-describedby="tbl-celltypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 8%">
<col style="width: 32%">
<col style="width: 26%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">hpo_branch</th>
<th style="text-align: left;">hpo_branch_id</th>
<th style="text-align: left;">cl_branch</th>
<th style="text-align: left;">cl_name</th>
<th style="text-align: left;">cl_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Abnormality of the cardiovascular system</td>
<td style="text-align: left;">HP:0001626</td>
<td style="text-align: left;">cardiocyte</td>
<td style="text-align: left;">cardiac muscle cell</td>
<td style="text-align: left;">CL:0000746</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the cardiovascular system</td>
<td style="text-align: left;">HP:0001626</td>
<td style="text-align: left;">cardiocyte</td>
<td style="text-align: left;">regular atrial cardiac myocyte</td>
<td style="text-align: left;">CL:0002129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the cardiovascular system</td>
<td style="text-align: left;">HP:0001626</td>
<td style="text-align: left;">cardiocyte</td>
<td style="text-align: left;">endocardial cell</td>
<td style="text-align: left;">CL:0002350</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the cardiovascular system</td>
<td style="text-align: left;">HP:0001626</td>
<td style="text-align: left;">cardiocyte</td>
<td style="text-align: left;">epicardial adipocyte</td>
<td style="text-align: left;">CL:1000309</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the cardiovascular system</td>
<td style="text-align: left;">HP:0001626</td>
<td style="text-align: left;">cardiocyte</td>
<td style="text-align: left;">ventricular cardiac muscle cell</td>
<td style="text-align: left;">CL:2000046</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the endocrine system</td>
<td style="text-align: left;">HP:0000818</td>
<td style="text-align: left;">endocrine cell</td>
<td style="text-align: left;">endocrine cell</td>
<td style="text-align: left;">CL:0000163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the endocrine system</td>
<td style="text-align: left;">HP:0000818</td>
<td style="text-align: left;">endocrine cell</td>
<td style="text-align: left;">neuroendocrine cell</td>
<td style="text-align: left;">CL:0000165</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the endocrine system</td>
<td style="text-align: left;">HP:0000818</td>
<td style="text-align: left;">endocrine cell</td>
<td style="text-align: left;">chromaffin cell</td>
<td style="text-align: left;">CL:0000166</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the eye</td>
<td style="text-align: left;">HP:0000478</td>
<td style="text-align: left;">photoreceptor cell / retinal cell</td>
<td style="text-align: left;">photoreceptor cell</td>
<td style="text-align: left;">CL:0000210</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the eye</td>
<td style="text-align: left;">HP:0000478</td>
<td style="text-align: left;">photoreceptor cell / retinal cell</td>
<td style="text-align: left;">amacrine cell</td>
<td style="text-align: left;">CL:0000561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the eye</td>
<td style="text-align: left;">HP:0000478</td>
<td style="text-align: left;">photoreceptor cell / retinal cell</td>
<td style="text-align: left;">Mueller cell</td>
<td style="text-align: left;">CL:0000636</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the eye</td>
<td style="text-align: left;">HP:0000478</td>
<td style="text-align: left;">photoreceptor cell / retinal cell</td>
<td style="text-align: left;">retinal pigment epithelial cell</td>
<td style="text-align: left;">CL:0002586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">T cell</td>
<td style="text-align: left;">CL:0000084</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">mature neutrophil</td>
<td style="text-align: left;">CL:0000096</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">mast cell</td>
<td style="text-align: left;">CL:0000097</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">microglial cell</td>
<td style="text-align: left;">CL:0000129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">professional antigen presenting cell</td>
<td style="text-align: left;">CL:0000145</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">macrophage</td>
<td style="text-align: left;">CL:0000235</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">B cell</td>
<td style="text-align: left;">CL:0000236</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">dendritic cell</td>
<td style="text-align: left;">CL:0000451</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">monocyte</td>
<td style="text-align: left;">CL:0000576</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">plasma cell</td>
<td style="text-align: left;">CL:0000786</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">alternatively activated macrophage</td>
<td style="text-align: left;">CL:0000890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">thymocyte</td>
<td style="text-align: left;">CL:0000893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the immune system</td>
<td style="text-align: left;">HP:0002715</td>
<td style="text-align: left;">leukocyte</td>
<td style="text-align: left;">innate lymphoid cell</td>
<td style="text-align: left;">CL:0001065</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the musculoskeletal system</td>
<td style="text-align: left;">HP:0033127</td>
<td style="text-align: left;">cell of skeletal muscle / chondrocyte</td>
<td style="text-align: left;">chondrocyte</td>
<td style="text-align: left;">CL:0000138</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the musculoskeletal system</td>
<td style="text-align: left;">HP:0033127</td>
<td style="text-align: left;">cell of skeletal muscle / chondrocyte</td>
<td style="text-align: left;">cell of skeletal muscle</td>
<td style="text-align: left;">CL:0000188</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the musculoskeletal system</td>
<td style="text-align: left;">HP:0033127</td>
<td style="text-align: left;">cell of skeletal muscle / chondrocyte</td>
<td style="text-align: left;">skeletal muscle satellite cell</td>
<td style="text-align: left;">CL:0000594</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">bipolar neuron</td>
<td style="text-align: left;">CL:0000103</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">granule cell</td>
<td style="text-align: left;">CL:0000120</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">Purkinje cell</td>
<td style="text-align: left;">CL:0000121</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">glial cell</td>
<td style="text-align: left;">CL:0000125</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">astrocyte</td>
<td style="text-align: left;">CL:0000127</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">oligodendrocyte</td>
<td style="text-align: left;">CL:0000128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">microglial cell</td>
<td style="text-align: left;">CL:0000129</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">neuroendocrine cell</td>
<td style="text-align: left;">CL:0000165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">chromaffin cell</td>
<td style="text-align: left;">CL:0000166</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">photoreceptor cell</td>
<td style="text-align: left;">CL:0000210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">inhibitory interneuron</td>
<td style="text-align: left;">CL:0000498</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">neuron</td>
<td style="text-align: left;">CL:0000540</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">neuronal brush cell</td>
<td style="text-align: left;">CL:0000555</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">amacrine cell</td>
<td style="text-align: left;">CL:0000561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">GABAergic neuron</td>
<td style="text-align: left;">CL:0000617</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">Mueller cell</td>
<td style="text-align: left;">CL:0000636</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">glutamatergic neuron</td>
<td style="text-align: left;">CL:0000679</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">retinal ganglion cell</td>
<td style="text-align: left;">CL:0000740</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">retina horizontal cell</td>
<td style="text-align: left;">CL:0000745</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">Schwann cell</td>
<td style="text-align: left;">CL:0002573</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">retinal pigment epithelial cell</td>
<td style="text-align: left;">CL:0002586</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">visceromotor neuron</td>
<td style="text-align: left;">CL:0005025</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the nervous system</td>
<td style="text-align: left;">HP:0000707</td>
<td style="text-align: left;">neural cell</td>
<td style="text-align: left;">sympathetic neuron</td>
<td style="text-align: left;">CL:0011103</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abnormality of the respiratory system</td>
<td style="text-align: left;">HP:0002086</td>
<td style="text-align: left;">respiratory epithelial cell / epithelial cell of lung</td>
<td style="text-align: left;">type II pneumocyte</td>
<td style="text-align: left;">CL:0002063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abnormality of the respiratory system</td>
<td style="text-align: left;">HP:0002086</td>
<td style="text-align: left;">respiratory epithelial cell / epithelial cell of lung</td>
<td style="text-align: left;">epithelial cell of lower respiratory tract</td>
<td style="text-align: left;">CL:0002632</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>hpo_deaths <span class="ot">&lt;-</span> KGExplorer<span class="sc">::</span><span class="fu">get_ontology_descendants</span>(<span class="at">ont =</span> hpo,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">include_self =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">terms =</span> <span class="st">"Age of death"</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Age of death</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to ids.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>deaths_dt <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">hpo_id=</span>hpo_deaths)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>deaths_dt <span class="ot">&lt;-</span> HPOExplorer<span class="sc">::</span><span class="fu">add_hpo_name</span>(deaths_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding HPO names.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Translating ontology terms to names.</code></pre>
</div>

<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dict <span class="ot">&lt;-</span> HPOExplorer<span class="sc">:::</span><span class="fu">hpo_dict</span>(<span class="at">type=</span><span class="st">"AgeOfDeath"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>deaths_dt[,encoding<span class="sc">:</span><span class="er">=</span>dict[hpo_name]] <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setorderv</span>(<span class="st">"encoding"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(deaths_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-death" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-death-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Encodings for Age of Death scores. Assigned numeric values for the Age of Death scores within the HPO annotations.
</figcaption>
<div aria-describedby="tbl-death-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">hpo_id</th>
<th style="text-align: left;">hpo_name</th>
<th style="text-align: right;">encoding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HP:0003826</td>
<td style="text-align: left;">Stillbirth</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">HP:0005268</td>
<td style="text-align: left;">Miscarriage</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HP:0034241</td>
<td style="text-align: left;">Prenatal death</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">HP:0003811</td>
<td style="text-align: left;">Neonatal death</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HP:0001522</td>
<td style="text-align: left;">Death in infancy</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">HP:0003819</td>
<td style="text-align: left;">Death in childhood</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HP:0011421</td>
<td style="text-align: left;">Death in adolescence</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">HP:0100613</td>
<td style="text-align: left;">Death in early adulthood</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HP:0033763</td>
<td style="text-align: left;">Death in adulthood</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">HP:0033764</td>
<td style="text-align: left;">Death in middle age</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HP:0033765</td>
<td style="text-align: left;">Death in late adulthood</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>